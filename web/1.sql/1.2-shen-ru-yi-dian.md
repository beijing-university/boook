# 1.2 深入一点

一、什么是[SQL注入](https://so.csdn.net/so/search?q=SQL%E6%B3%A8%E5%85%A5\&spm=1001.2101.3001.7020)漏洞\
攻击者利用Web应用程序对用户输入验证上的疏忽，在输入的数据中包含对某些数据库系\
统有特殊意义的符号或命令，让攻击者有机会直接对后台数据库系统下达指令，进而实现对后\
台数据库乃至整个应用系统的入侵

二、SQL注入原理\
服务端没有过滤用户输入的恶意数据，直接把用户输入的数据当做[SQL语句](https://so.csdn.net/so/search?q=SQL%E8%AF%AD%E5%8F%A5\&spm=1001.2101.3001.7020)执行，从而影响\
数据库安全和平台安全。

两个条件\
用户能够控制输入\
原本程序要执行的SQL语句，拼接了用户输入的恶意数据

三、SQL注入过程

①攻击者访问有SQL注入漏洞的网站，寻找注入点\
②攻击者构造注入语句，注入语句和程序中的SoL语句结合生成新的sq1语句\
③新的sql语句被提交到数据库中进行处理\
④数据库执行了新的SQL语句，引发SQL注入攻击

四、SQL注入带来的危害\
绕过登录验证：使用万能密码登录网站后台等\
获取敏感数据：获取网站管理员帐号、密码等\
文件系统操作：列目录，读取、写入文件等\
注册表操作：读取、写入、删除注册表等\
执行系统命令：远程执行命令

如通过在用户名处传入参数(' or 1=1 -- )进行万能密码登录(注意空格)

输入字符\
formusr =' or 1=1--\
formpwd = anything\
实际的查询代码

SELECT\*FROM users WHERE username =' or 1=1-- AND password ='anything'

五、判断一个HTTP请求是否存在SQL注入的方式\
经典：and 1=1 | and 2>1 | or 1=1 |or 1<1\
数据库函数：sleep(4)=1 | length(user())>3\
特殊符号：单引号(')双引号(")

六、SQL注入分类\
按照注入参数类型分类\
[数字型（整型）注入](https://blog.csdn.net/Gjqhs/article/details/122968269?spm=1001.2014.3001.5501)\
[字符型注入](https://blog.csdn.net/Gjqhs/article/details/122972761?spm=1001.2014.3001.5501)

搜索型注入\
按照注入技术（执行效果）分类\
[基于布尔的盲注 即可以根据返回页面判断条件真假的注入。](https://blog.csdn.net/Gjqhs/article/details/123014537?spm=1001.2014.3001.5501)

[基于时间的盲注 即不能根据页面返回内容判断任何信息，用条件语句查看时间延退语句是否执行](https://blog.csdn.net/Gjqhs/article/details/123020424?spm=1001.2014.3001.5501)

[基于报错的注入 即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中](https://blog.csdn.net/Gjqhs/article/details/122994081?spm=1001.2014.3001.5501)\
联合查询注入       可以使用union的情况下的注入\
堆查询注入           同时执行多条语句的注入。

是否回显也可称分显注、盲注

或是请求方式分为

GE注入\
POST注入\
Cookie注入\
HTTPHeader注入

七、SQL注入漏洞形成的原因\
动态字符串构建引起\
[不正确的处理转义字符（宽字节注入）](https://blog.csdn.net/Gjqhs/article/details/123036995?spm=1001.2014.3001.5501)\
不正确的处理错误（报错泄露信息）\
不正确的处理联合查询\
[不正确的处理多次提交（二次注入）](https://blog.csdn.net/Gjqhs/article/details/123036304?spm=1001.2014.3001.5501)

\
后台存在的问题\
后台无过滤或者编码用户数据\
数据库可以拼接用户传递的恶意代码

错误处理不当\
详细的内部错误消息显示给用户或攻击者\
错误信息可以直接给攻击者提供下一步攻击帮助
